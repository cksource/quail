<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<title>Issue sample</title>
	</head>
	<body>
		<h1>Double keydown event</h1>
		<p>
			This issue occurs only on FireFox. Use <kbd>Enter</kbd> key to trigger sync AJAX request. Note that selection <strong>must be</strong> in <code>div#selectionContainer</code>.
		</p>
		<p>
			You should have one new line inserted for press. This is because we don&apos;t cancel the event. But it turns that FF will insert 2 line breaks.
		</p>
		<p>
			What about canceled event? Well if you'll cancel the event it will still insert 1 line break, even though you explicitly denied it.
		</p>
		
		<h2>Editable:</h2>
		<div id="selectionContainer" contenteditable="true">Put your selection here</div>
		
		<script>
			var selectionContainer = document.getElementById( 'selectionContainer' ),
				KEY_CODES = {
					E_KEY: 69,
					SPACE: 32,
					ENTER: 13
				};
			
			// Focus the container, so we don't need to do it manually.
			selectionContainer.focus();
			
			selectionContainer.addEventListener( 'keydown', function( evt ) {
				// Listen to keydown event and dispatch a synchronous AJAX request.
				if ( evt.keyCode === KEY_CODES.ENTER ) {
					var request = new XMLHttpRequest();
					// Don't worry, it doesn't matter if we get 404.
					request.open('GET', 'dist/tests.json', false);  // `false` for synchronous request.
					request.send(null);
				}
			} );
			
			selectionContainer.addEventListener( 'keypress', function( evt ) {
				if ( evt.key === 'Enter' ) {
					console.log( 'keypress', evt );
				}
			} );
			
			selectionContainer.addEventListener( 'keyup', function( evt ) {
				if ( evt.keyCode === KEY_CODES.ENTER ) {
					console.log( 'keyup', evt );
				}
			} );
		</script>
	</body>
</html>